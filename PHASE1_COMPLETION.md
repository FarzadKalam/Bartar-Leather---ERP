# Phase 1: Material Management System - ุชฺฉูู ุดุฏ โ

**ุชุงุฑุฎ:** 7 ฺุงููู 2026  
**ูุณุฎู:** 1.0  
**ูุถุนุช:** โ ุชฺฉูู ุดุฏู

---

## ๐ ุฎูุงุตู ฺฉุงุฑูุง ุงูุฌุงู ุดุฏู

### ฑ. **ุจุฑูุฒุฑุณุงู productsConfig.ts**
โ ุชุตุญุญ blocks ุจุฑุง ุฌุฏุงูู ููุงุฏ:
- ุชุบุฑ ูุงู `bundleItems` โ `semiBundleItems` (ุจุฑุง ุจุณุชู ูููโุขูุงุฏู)
- ุชุบุฑ ูุงู `finalProductBOM` โ `finalProductMaterials` (ุจุฑุง ูุญุตูู ููุง)
- ุญุฐู `externalDataConfig` ุบูุท
- ุงุถุงููโุณุงุฒ ููุฏ `related_bom` (ุจุฑุง ูุญุตูู ููุง)

โ ุชุตุญุญ blocks:
- ุฌุฏูู ุจุณุชู ูููโุขูุงุฏู: ููุชุฑ ุจุฑุง ููุท ููุงุฏ ุงููู (`product_type: 'raw'`)
- ุฌุฏูู ูุญุตูู ููุง: ููุงุด ุงููุงู BOM ุจุง calculated `total_price`
- visibleIf conditions: ุงููุงู ููุท ุฒูุงู ููุงุด ุฏุงุฏู ุดููุฏ ฺฉู product_type ุตุญุญ ุจุงุดุฏ

### ฒ. **ุงุฌุงุฏ productBundlesConfig.ts** โ
- ูุงฺูู ฺฉุงูู ุจุฑุง ุจุณุชูโูุง ูุญุตูู (product_bundles)
- Fields: bundle_number, status, shelf_id, notes
- Block: ุฌุฏูู ุงููุงู ุจุณุชู (ุจุง ููุชุฑ ุจุฑุง ููุงุฏ ุงููู)
- RelatedTabs: ููุงุด ูุญุตููุงุช ุงุณุชูุงุฏูโฺฉููุฏู

### ณ. **ุจุฑูุฒุฑุณุงู productionConfig.ts** โ
- ุงุถุงููโุณุงุฒ block ุฏุฑ productionOrderModule
- ุฌุฏูู "bomMaterials": ููุงุด ุงููุงู BOM ุงูุชุฎุงุจโุดุฏู (reference)
- Validation ุงุถุงูู ุจุฑุง order_numberุ bom_idุ quantity

### ด. **ุจุฑูุฒุฑุณุงู moduleRegistry.ts** โ
- ุงุถุงููโุณุงุฒ `product_bundles` ุจู MODULES

---

## ๐ฏ ูฺฺฏโูุง ูพุงุฏูโุดุฏู

### โ ุฌุณุชุฌู ู ุงุณฺฉู ุจุงุฑฺฉุฏ
- **EditableTable.tsx** ูุจูุงู ุฏุงุฑุง:
  - Select ุจุง `showSearch` ู `filterOption`
  - Modal ุจุฑุง ุงุณฺฉู ุจุงุฑฺฉุฏ (`QrcodeOutlined`)
  - ุชุงุจุน `processScan()` ุจุฑุง ุชุทุงุจู ฺฉุฏ

### โ ุฌุฏุงูู ูุดุฑูุท
- **productsConfig:**
  - `product_type: 'semi'` โ ุฌุฏูู ุจุณุชู ูููโุขูุงุฏู
  - `product_type: 'final'` โ ุฌุฏูู ูุฑููู ุณุงุฎุช (BOM)
  
- **productBundlesConfig:**
  - ุฌุฏูู ุงููุงู ุจุง ููุชุฑ ุฎูุฏฺฉุงุฑ

### โ ุฑูุงุจุท (Relations)
- `products.related_bom` โ `production_boms.id` (ูุญุตูู ููุง)
- `product_bundles.bundle_items` โ `products.id` (ููุงุฏ ุงููู)
- `production_orders.bom_id` โ `production_boms.id`

### โ ูุญุงุณุจุงุช ุฎูุฏฺฉุงุฑ
- `total_price = usage ร buy_price` (ุฏุฑ ุฌุฏุงูู)
- `readonly: true` ุจุฑุง calculated fields

---

## ๐ ููุงุด ุงุทูุงุนุงุช

### ูุญุตูู ูููโุขูุงุฏู (product_type: 'semi')
```
โโ ูุญุตูู ูููโุขูุงุฏู
โ
โโ ุฌุฏูู ุงููุงู ุจุณุชู
   โโ ูุญุตูู (ููุงุฏ ุงููู) - Select ุฌุณุชุฌู + ุงุณฺฉู
   โโ ููุฏุงุฑ - Number
   โโ [+ ุงูุฒูุฏู ุฑุฏู ุฌุฏุฏ]
```

### ูุญุตูู ููุง (product_type: 'final')
```
โโ ูุญุตูู ููุง
โ
โโ ุงูุชุฎุงุจ ุดูุงุณูุงูู (BOM) - Select ุฌุณุชุฌู
โ
โโ ุฌุฏูู ูุฑููู ุณุงุฎุช
   โโ ูุงุฏู ุงููู (Reference ุงุฒ BOM)
   โโ ููุฏุงุฑ ูุตุฑู
   โโ ูุงุญุฏ
   โโ ููุช ุฎุฑุฏ
   โโ ุฌูุน (calculated)
```

### ุณูุงุฑุด ุชููุฏ
```
โโ ุณูุงุฑุด ุชููุฏ
โ
โโ ุดูุงุฑู ุณูุงุฑุด - Text
โโ ุงูุชุฎุงุจ BOM - Select ุฌุณุชุฌู
โโ ุชุนุฏุงุฏ ุชููุฏ - Number
โโ ูุถุนุช - Status
โ
โโ ุฌุฏูู ุงููุงู BOM (Reference)
   โโ ูุงุฏู ุงููู
   โโ ููุฏุงุฑ ูุตุฑู
   โโ ูุงุญุฏ
   โโ ...
```

---

## ๐ Data Flow

### ุณูุงุฑู ฑ: ุงุฌุงุฏ ุจุณุชู ูููโุขูุงุฏู
```
1. ูุฑู ูุญุตูู ุฌุฏุฏ ุจุงุฒ ุดูุฏ
2. product_type = 'semi' ุงูุชุฎุงุจ ุดูุฏ
3. ุฌุฏูู "ุงููุงู ุจุณุชู ูููโุขูุงุฏู" ููุงุด ุฏุงุฏู ุดูุฏ
4. ฺฉุงุฑุจุฑ ุจุฑุง ูุฑ ุฑุฏู:
   - ูุญุตูู (ููุงุฏ ุงููู) ุฑุง ุฌุณุชุฌู ฺฉูุฏ ุง ุงุณฺฉู ฺฉูุฏ
   - ููุฏุงุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ
5. ุฐุฎุฑูโุณุงุฒ ุฏุฑ: products.semiBundleItems
```

### ุณูุงุฑู ฒ: ุงุฌุงุฏ ูุญุตูู ููุง ุจุง BOM
```
1. ูุฑู ูุญุตูู ุฌุฏุฏ ุจุงุฒ ุดูุฏ
2. product_type = 'final' ุงูุชุฎุงุจ ุดูุฏ
3. ููุฏ "ุงูุชุฎุงุจ ุดูุงุณูุงูู (BOM)" ููุงุด ุฏุงุฏู ุดูุฏ
4. ฺฉุงุฑุจุฑ BOM ุฑุง ุฌุณุชุฌู ฺฉูุฏ (ุง ุงุฌุงุฏ ฺฉูุฏ)
5. ุฌุฏูู ุงููุงู BOM ููุงุด ุฏุงุฏู ุดูุฏ (reference - read-only)
6. ุฐุฎุฑูโุณุงุฒ: products.related_bom
```

### ุณูุงุฑู ณ: ุงุฌุงุฏ ุณูุงุฑุด ุชููุฏ
```
1. ูุฑู ุณูุงุฑุด ุชููุฏ ุฌุฏุฏ ุจุงุฒ ุดูุฏ
2. BOM ุงูุชุฎุงุจ ุดูุฏ
3. ุชุนุฏุงุฏ ุชููุฏ ูุงุฑุฏ ุดูุฏ
4. ุฌุฏูู ุงููุงู BOM (reference) ููุงุด ุฏุงุฏู ุดูุฏ
5. ุฐุฎุฑูโุณุงุฒ ุฏุฑ: production_orders
```

---

## ๐ ูุงูโูุง ุชุบุฑ ุงูุชู

| ูุงู | ููุน ุชุบุฑ |
|------|----------|
| `modules/productsConfig.ts` | โ๏ธ ุจุฑูุฒุฑุณุงู ุดุงูู: blocks, fields |
| `modules/productBundlesConfig.ts` | โจ ุงุฌุงุฏ ุฌุฏุฏ |
| `modules/productionConfig.ts` | โ๏ธ ุจุฑูุฒุฑุณุงู production_orders |
| `moduleRegistry.ts` | โ๏ธ ุงุถุงููโุณุงุฒ product_bundles |

---

## โ๏ธ ูฺฉุงุช ููู

### Database
- โ ุฌุฏุงูู ููุฌูุฏ: `products`, `product_bundles`, `bundle_items`, `bom_items`, `production_orders`
- โ๏ธ ููุฏ `related_bom` ุฏุฑ `products` - ูุงุฒ ุจู migration ุงฺฏุฑ ูุจุงุดุฏ
- โ๏ธ ุฌุฏูู `production_stages` - ูููุฒ ุงุฌุงุฏ ูุดุฏู (ุจุฑุง phase ุจุนุฏ)

### Validations
- โ Required fields: order_number, bom_id, quantity
- โ๏ธ Unique constraint ุจุฑุง bundle_number - ูุงุฒ ุจู ุจุฑุฑุณ database

### Performance
- โ Filter ุฏุฑ relations ุจุฑุง ฺฉุงูุด options (ููุท raw materials)
- โ๏ธ ุจุฏูู pagination - ุจุฑุง list ุจุฒุฑฺฏ ููฺฉู ุงุณุช slow ุดูุฏ

---

## ๐ ูุฏูโูุง ุจุนุฏ (Phase 2)

- [ ] Production Stages ุฌุฏูู
- [ ] Tasks auto-creation ุจุฑุง ูุฑ stage
- [ ] Stock allocation ู usage tracking
- [ ] Completed reports
- [ ] Cost calculation ู analysis

---

**ูุณุฎู ุจุนุฏ:** Production Stages & Tasks Integration
